---
title: 'Приём платежей'
description: 'Платёжный фрейм'
---


## {{title}}



```mermaid
sequenceDiagram
autonumber
    participant site as Ваш сайт #lightGreen
    participant server as Ваш сервер
    participant finmart as API Finmart 
    participant	payment as Платёжный провайдер



    site->>server: Пользователь нажимает кнопку метода 
    server->>finmart: Запрос на получение ссылки на платёжную страницу 
    finmart-->>payment: 
    payment-->finmart: 
    finmart-->>+server: Ссылка на платёжную страницу 
    server->>site: Показ пользователю платёжной страницы
    note over site:  Пользователь проходит платёжный флоу
    payment-->>site: Перенаправление пользователя на url_success или url_result
    finmart-->>server: Уведомление
    server-->>-site: Обработка операций
    server->>finmart: Установка POST /api/operation/set_ack_id    
    loop Обработка новых успешных операций
		    server->>finmart: GET /v3/operation/unconfirmed
		    finmart-->>server: array()
	     note over server: Обработка операций
			  server->>finmart: Сообщить о успешной обработке POST /api/v3/operation/confirm
        server -->>site: Обновление баланса
        server->>finmart: Установка operation_ack_id POST /api/operation/set_ack_id    
    end
    
```



## Возможные схемы взаимодействия

### Работа по колбекам

<Steps>
  <Step title="Оператор отправляет запрос на создание операции и перенаправляет пользователя на полученный URL">
    
  </Step>
  <Step title="Пользователь вводит данные карты">
    
  </Step>
  <Step title="3ds-подтверждение платежа">
    
  </Step>
  <Step title="Оператор получает уведомление о завершении платежа на переданный url_callback">
    
  </Step>
  <Step title="New Step">
    
  </Step>
</Steps>

<Expandable>
  
</Expandable>

<Expandable>
  ```bash Response
  {
      "success": true,
      "result": {
          "url": "https://card.cheipho.com/transaction/6e89d40d-3fda-42a2-9c97-3564c8443c3a",
          "reference_id": "6e89d40d-3fda-42a2-9c97-3564c8443c3a"
      },
      "trace_id": "8abfc59b1bd149b9a3e56e0226a4c796"
  }
  ```
</Expandable>

...


